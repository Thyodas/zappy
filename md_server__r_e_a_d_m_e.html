<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Zappy: Zappy Server</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Zappy<span id="projectnumber">&#160;1.2</span>
   </div>
   <div id="projectbrief">Documentation for the Zappy project at EPITECH</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_server__r_e_a_d_m_e.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Zappy Server </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >This is a C server that generates a virtual world for the inhabitants.</p>
<h1>Usage</h1>
<div class="fragment"><div class="line">cmake .</div>
<div class="line">make</div>
<div class="line">./zappy_server -p port -x width -y height -n name1 name2 ... -c clientsNb -f freq</div>
</div><!-- fragment --><ul>
<li>port is the port number.</li>
<li>width is the width of the world.</li>
<li>height is the height of the world.</li>
<li>nameX is the name of the team X.</li>
<li>clientsNb is the number of authorized clients per team.</li>
<li>freq is the reciprocal of time unit for execution of actions.</li>
</ul>
<h1>Architecture</h1>
<p >The server uses select for socket multiplexing, which only unlocks if there's an event on a socket or an event is ready to be executed. The server is executed as a single process with a single thread.</p>
<h1>Client AI/Server Communication</h1>
<p >The dialogue between the AI client and the server is via TCP sockets, the port of which must be specified in the parameters. The client sends requests without waiting for their execution. The server responds with a message confirming the successful execution of the requests.</p>
<p >The client’s connection to the server happens as follows:</p>
<ol type="1">
<li>The client opens a socket on the server’s port.</li>
<li>The server and the client communicate in the following way:<ul>
<li>Server: WELCOME <br  />
</li>
<li>Client: TEAM-NAME <br  />
</li>
<li>Server: CLIENT-NUM <br  />
 and X Y <br  />
 X and Y indicate the world’s dimensions. CLIENT-NUM indicates the number of slots available on the server for the TEAM-NAME team. If this number is greater than or equal to 1, a new client can connect.</li>
</ul>
</li>
</ol>
<p >The client can send up to 10 requests in a row without any response from the server. Over 10, the server will no longer take them into account. The server executes the client’s requests in the order they were received. The requests are buffered and a command’s execution time only blocks the player in question.</p>
<h1>Time</h1>
<p >There should not be any blockage when the clients are stopped, nor in any phase of the game. The time unit is seconds. An action’s execution time is calculated with the following formula: action / f, where f is an integer representing the reciprocal (multiplicative inverse) of time unit. For instance, if f=1, “forward” takes 7 / 1 = 7 seconds. By default, f=100.</p>
<h1>AI Commands</h1>
<p >Each player responds to the following actions:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Action   </th><th class="markdownTableHeadNone">Command   </th><th class="markdownTableHeadNone">Time Limit   </th><th class="markdownTableHeadNone">Response    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Move up one tile   </td><td class="markdownTableBodyNone">Forward   </td><td class="markdownTableBodyNone">7/f   </td><td class="markdownTableBodyNone">ok    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Turn 90o right   </td><td class="markdownTableBodyNone">Right   </td><td class="markdownTableBodyNone">7/f   </td><td class="markdownTableBodyNone">ok    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Turn 90o left   </td><td class="markdownTableBodyNone">Left   </td><td class="markdownTableBodyNone">7/f   </td><td class="markdownTableBodyNone">ok    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Look around   </td><td class="markdownTableBodyNone">Look   </td><td class="markdownTableBodyNone">7/f   </td><td class="markdownTableBodyNone">[tile1, tile2,. . . ]    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Inventory   </td><td class="markdownTableBodyNone">Inventory   </td><td class="markdownTableBodyNone">1/f   </td><td class="markdownTableBodyNone">[linemate n, sibur n,. . . ]    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Broadcast text   </td><td class="markdownTableBodyNone">Broadcast text   </td><td class="markdownTableBodyNone">7/f   </td><td class="markdownTableBodyNone">ok    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Number of team unused slots   </td><td class="markdownTableBodyNone">Connect_nbr   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">value    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Fork a player   </td><td class="markdownTableBodyNone">Fork   </td><td class="markdownTableBodyNone">42/f   </td><td class="markdownTableBodyNone">ok    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Eject players from this tile   </td><td class="markdownTableBodyNone">Eject   </td><td class="markdownTableBodyNone">7/f   </td><td class="markdownTableBodyNone">ok/ko    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Death of a player   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">dead    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Take object   </td><td class="markdownTableBodyNone">Take object   </td><td class="markdownTableBodyNone">7/f   </td><td class="markdownTableBodyNone">ok/ko    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Set object down   </td><td class="markdownTableBodyNone">Set object   </td><td class="markdownTableBodyNone">7/f   </td><td class="markdownTableBodyNone">ok/ko    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Start incantation   </td><td class="markdownTableBodyNone">Incantation   </td><td class="markdownTableBodyNone">300/f   </td><td class="markdownTableBodyNone">Elevation underway. Current level: k or ko   </td></tr>
</table>
<p >All commands are transmitted through a character string that ends with a new line.</p>
<h1>GUI/Server Commands</h1>
<p >Here's the commands and their meanings formatted into tables in Markdown:</p>
<h1>Symbols</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">SYMBOL   </th><th class="markdownTableHeadNone">MEANING    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">X   </td><td class="markdownTableBodyNone">Width or horizontal position    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Y   </td><td class="markdownTableBodyNone">Height or vertical position    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">q0   </td><td class="markdownTableBodyNone">Resource 0 (food) quantity    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">q1   </td><td class="markdownTableBodyNone">Resource 1 (linemate) quantity    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">q2   </td><td class="markdownTableBodyNone">Resource 2 (deraumere) quantity    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">q3   </td><td class="markdownTableBodyNone">Resource 3 (sibur) quantity    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">q4   </td><td class="markdownTableBodyNone">Resource 4 (mendiane) quantity    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">q5   </td><td class="markdownTableBodyNone">Resource 5 (phiras) quantity    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">q6   </td><td class="markdownTableBodyNone">Resource 6 (thystame) quantity    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">n   </td><td class="markdownTableBodyNone">Player number    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">O   </td><td class="markdownTableBodyNone">Orientation: 1(N), 2(E), 3(S), 4(W)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">L   </td><td class="markdownTableBodyNone">Player or incantation level    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">e   </td><td class="markdownTableBodyNone">Egg number    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">T   </td><td class="markdownTableBodyNone">Time unit    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">N   </td><td class="markdownTableBodyNone">Name of the team    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">R   </td><td class="markdownTableBodyNone">Incantation result    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">M   </td><td class="markdownTableBodyNone">Message    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">i   </td><td class="markdownTableBodyNone">Resource number   </td></tr>
</table>
<h1>Server-Client Commands</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">SERVER COMMAND   </th><th class="markdownTableHeadNone">CLIENT COMMAND   </th><th class="markdownTableHeadNone">DETAILS    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">msz X Y<br  />
   </td><td class="markdownTableBodyNone">msz<br  />
   </td><td class="markdownTableBodyNone">Map size    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">bct X Y q0 q1 q2 q3 q4 q5 q6<br  />
   </td><td class="markdownTableBodyNone">bct X Y<br  />
   </td><td class="markdownTableBodyNone">Content of a tile    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">bct X Y q0 q1 q2 q3 q4 q5 q6<br  />
   </td><td class="markdownTableBodyNone">* nbr_tiles mct<br  />
   </td><td class="markdownTableBodyNone">Content of the map (all the tiles)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">tna N<br  />
   </td><td class="markdownTableBodyNone">* nbr_teams tna<br  />
   </td><td class="markdownTableBodyNone">Name of all the teams    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">pnw #n X Y O L N<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Connection of a new player    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ppo n X Y O<br  />
   </td><td class="markdownTableBodyNone">ppo #n<br  />
   </td><td class="markdownTableBodyNone">Player’s position    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">plv n L<br  />
   </td><td class="markdownTableBodyNone">plv #n<br  />
   </td><td class="markdownTableBodyNone">Player’s level    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">pin n X Y q0 q1 q2 q3 q4 q5 q6<br  />
   </td><td class="markdownTableBodyNone">pin #n<br  />
   </td><td class="markdownTableBodyNone">Player’s inventory    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">pex n<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Expulsion    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">pbc n M<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Broadcast    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">pic X Y L n n . . . <br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Start of an incantation (by the first player)    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">pie X Y R<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">End of an incantation    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">pfk n<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Egg laying by the player    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">pdr n i<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Resource dropping    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">pgt n i<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Resource collecting    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">pdi n<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Death of a player    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">enw e n X Y<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">An egg was laid by a player    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ebo e<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Player connection for an egg    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">edi e<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Death of an egg    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">sgt T<br  />
   </td><td class="markdownTableBodyNone">sgt<br  />
   </td><td class="markdownTableBodyNone">Time unit request    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">sst T<br  />
   </td><td class="markdownTableBodyNone">sst T<br  />
   </td><td class="markdownTableBodyNone">Time unit modification    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">seg N<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">End of game    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">smg M<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Message from the server    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">suc<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Unknown command    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">sbp<br  />
   </td><td class="markdownTableBodyNone">-   </td><td class="markdownTableBodyNone">Command parameter   </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
